# 绪论

- 简介

  教材：计算机组成与系统结构（第二版） 裘雪红 西电出版社

  计算机组成原理和计算机系统结构
  
  ![image-20210421144227693](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144244.png)

## 计算机发展史

### 发展

- 计算机

  电子数字计算机，是指能对离散逻辑符号表示的数据或信息进行自动处理的电子装置，简称计算机。

  计算机的发展根据所使用的电子元器件划分为 机械计算器、电子管计算机、晶体管计算机、中小规模集成电路计算机、大规模和超大规模集成电路计算机、巨大规模集成电路计算机。

- 第 0 代—机械计算器

  + 简介

    算盘，最简单实用的机械计算器

  + 时间

    公元前 5 世纪

  + 备注

    近代，发明了计算尺及手摇机械计算器

    布尔代数，及现代计算机奠定了理论基础

- 第 1 代—电子管计算机

  + 时间

    1946-1957

  + 器件

    电子管、电磁继电器

  + 软件

    使用机器语言编程

  + 典型机器

    * ABC

      Atanasoff-Berry 计算机，世界上第一台用电子管制造的二进制电子计算机，是为了求解线性方程系统专门制造的，不能称为通用计算机

      约翰·文森特·阿塔纳索夫(John Vincent Atanasoff)

      克利福特·贝瑞(Clifford Berry)

    * ENIAC

      Electronic Numerical Integrator And Computer 电子数字积分计算机，是世界上第一台全电子通用数字计算机。用十进制表示数字，算法也以十进制完成。必须手动编程，通过设置开关和插拔电缆插头实现

      John Wiliam Mauchly

      John Presper Eckert

    * UNIVAC I

      ENIAC 的开发者，制造的第一个成功的商用计算机型号

    * IBM 701

      IBM 生产的首台程序 存储计算机，主要面向科学计算

- 第 2 代—晶体管计算机
  + 时间
  
    1958-1964
  
+ 器件
  
    晶体管、磁芯存储器
  
  + 软件
  
    软件上采用监控程序对计算机进行管理，开始使用高级语言
  
  + 典型机器
  
    + TRADIC
  
      贝尔实验室使用 800 只晶体管组装了世界上第一台晶体管计算机
  
    * PDP-1
  
      数字设备公司(DEC Digital Equipment Corporation)
  
    * IBM 7094
  
      IBM 推出，主要用于科学计算领域
  
    * CDC 6600
  
      控制数据公司(CDC Control Data Corporation) 推出世界上第一台超级计算机，由西摩·克雷(Seymour Cray) 主持研发，是首个使用 CRT(阴极射线管)显示终端的商用计算机，首次使用了氟利昂制冷剂冷却系统用于散热
  
- 第 3 代—中小规模集成电路计算机
  + 时间
  
    1965-1971
  
+ 器件
  
    小规模及中规模集成电路芯片、多层印刷电路板及磁芯存储器
  
  + 软件
  
    高级语言迅速发展，出现了分时操作系统，具有分时共享和多道程序处理（及多人同时使用一台计算机）能力
  
  + 典型机器
  
    * IBM 360
  
      IBM 研制成功世界上第一个采用集成电路的通用计算机 IBM 360 系统，成为第三代计算机的里程碑。首次提出系列机的概念，即同一系列的计算机必须保证软件向下兼容（即，低端型号计算机上运行的软件无须修改，就可以直接在高端型号计算机上运行）
  
    * PDP-8
  
      DEC 创造了小型机的概念，首次使用了 Omnibus 单总线结构，此后，这种总线结构几乎被所有的小型机、微型机采用
  
    * PDP-11
  
      最早运行 AT&T UNIX 操作系统（用 C 语言开发）的计算机，最初的 BSD UNIX 操作系统也是在 PDP-11 上开发的
  
- 第 4 代—大规模和超大规模集成电路计算机
  + 时间
  
    1972-2010
  
+ 器件
  
    大规模、超大规模集成电脑
  
    * 计算机中的存储器由半导体存储器实现
  
      仙童半导体公司，又称飞兆半导体公司 Fairchild Semiconductor 生产了第一个容量较大的半导体存储器
  
    * 微处理器广泛使用
  
      微处理器-超大规模集成技术的发展和集成电路芯片集成度的迅速提高，可以将构成 CPU 的所有元件集成在一块集成电路芯片中，这样的芯片称为微处理器。
  
      Inter 推出了世界上第一个微处理器芯片 4004（4 位），之后推出了第一个通用微处理器 8080（8 位），之后推出了 x86 系列第一款微处理器 8086（16 位）
  
  + 软件
  
    微软公司的 DOS、Windows，苹果公司的 macOS，以及 UNIX、Linux
  
  + 典型机器
  
    * IBM PC
  
      IBM 推出的首款个人计算机，也称作微型计算机，其微处理器采用 Intel 8088，主存、接口电路均采用集成电路芯片
  
      IBM PC 兼容机
  
    * 苹果机
  
      Apple Lisa 是第一台使用图形用户界面的计算机，使用了摩托罗拉的 16 位 68000 微处理器芯片
  
    * Cray-1
  
      集成电路技术的发展促进了功能更强大的超级计算机的开发
  
- 第 5 代—巨大规模集成电路计算机
  + 时间
  
    2010-现在
  
+ 器件
  
    巨大规模、超高速集成电路
  
    * 多处理器
  
      IBM 推出 POWER4 双核体系结构，首次将两个 CPU 内核集成在一个微处理器芯片中。
  
      多核体系结构，在一个微处理器芯片中集成了多个 CPU 内核、大容量的多级高速缓存、多路主存控制器、图形处理器、多种高速总线与接口，支持多通道大容量主存。这样的微处理器芯片包含除主存、辅助存储器之外构成计算机所需的绝大部分元件和电路，称为片上系统
  
    * 多处理器系统
  
      多个多核处理器构成计算机，实现多个处理器，多个内核并行工作
  
    * 多计算机系统
  
      上万台计算机（多处理器系统）作为节点，通过高速的互连网络连接在一起，各节点协同工作，共同完成规模非常大的任务，这样的体系结构称为多计算机系统
  
  + 软件
  
  + 典型机器

### 摩尔定律

- 简介

  摩尔预言：单位面积集成电路上的晶体管数量每一年就会翻番，而计算性能也将随之翻番

  至今，集成电路芯片的集成度：DRAM 每 18 个月、微处理器每 24 个月（两年）翻一倍

### 计算机 500 强

- 简介

  我国目前运行速度最快的超级计算机是神威太湖之光

## 计算机的分层组织结构

- 简介

  ![image-20210421111031654](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144245.png)

  三部分：计算机体系结构、组成与实现

### 计算机体系结构、组成与实现

- 计算机体系结构

  程序员所看到的计算机系统的属性，即**概念性结构及功能特性**。

  不同层次上的程序员所看到的计算机系统的属性是不尽相同的，低的机器语言级上的概念性结构及功能特性，高级语言以上级别的程序员可能是看不见的（透明）

  在定义计算机体系结构的年代里，计算机的属性、概念性结构及功能特性主要是低层的硬件

  今天的计算机体系结构(系统结构)所指的计算机的属性主要包括：

  ![image-20210421111655162](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144246.png)

- 计算机组成

  是计算机系统的**逻辑实现**，包括最底层内部算法、数据流、控制流的逻辑实现

  计算机组成的设计主要包括

  ![image-20210421111847362](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144247.png)

- 计算机实现

  计算机组成的**物理实现**

  ![image-20210421111939945](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144248.png)

- 计算机体系结构、组成与实现的关系

  体系结构决定了计算机的总体属性，组成是体现这些属性的逻辑设计，而实现则是用物理器件来实现逻辑设计。

  相同的体系结构可以有不同的组成，相同的组成可以有不同的实现。

  ![image-20210421112131884](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144249.png)

## 计算机的基本组成

- 简介

  ![image-20210421112924281](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144250.png)

  题目：计算机的基本组成包括：CPU、存储器、IO设备、操作系统

### 硬件与软件

- 简介

  计算机由硬件和软件两大部分组成，其基本功能为控制、运算、存储和传输

- 软硬件的逻辑等价性

  任何操作、指令可以由硬件完成，也可以由软件来完成

- 软件硬化

  如整数乘除法指令、浮点运算指令、处理字符串指令等等，改为直接由硬件完成

- 软件固化

  现在已经可以把许多复杂的、常用的程序制作成所谓固件。甚至通过硬件直接解释执行高级语言的语句而不需要先经过编译程序的处理，即“固化”转“硬化”

### 指令集体系结构

- 简介

  每条指令可以实现计算机系统内最基本的操作

  早期，软件都是针对特定计算机系统硬件编写的，即使同一公司的不同计算机产品，其软件也不能通用

  IBM 公司在设计 System/360 大型机时，首次引入了**指令集体系结构**的概念，将编程所需了解的硬件信息从硬件系统的具体实现中抽象出来 

  处理器支持的指令和指令的字节级编码称为**指令集体系结构**(Instruction-Set Architecture ISA)，也称为**指令系统结构**(Instruction System Architecture )

- ISA

  ISA 是软件和硬件的分界面，是软件和硬件之间接口的完整定义

  软件（程序）是由 ISA 规定的“指令”组成的，==软件设计者==可以面向 ISA 进行编程，开发出的软件可以不经修改直接在相同ISA的计算机系统上运行

  ==编译器设计值==需要知道 ISA 规定了哪些指令，它们是如何编码的，以便实现将高级语言程序源代码转换为处理器能够识别并执行的机器语言代码

  ==处理器设计者==的任务是实现 ISA 规定的指令、功能和相应的硬件模块

- ISA 的规定

  ISA 不仅要规定指令集，还要定义任何系统程序员需要了解的硬件信息，因此，ISA 需要规定计算机程序员可见的所有组件及操作，包括：指令集、软件可见的处理器状态、存储模型、系统模型

  ![image-20210421114341663](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144251.png)

- 典型的 ISA

  ![image-20210421114531973](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144252.png)

### 冯·诺依曼计算机

- 硬件结构

  ![image-20210421114717656](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144253.png)

- 特点
  + 计算机由运算器（算术逻辑部件 ALU）、存储器、控制器、输入设备和输出设备五大部件组成
  + 依据存储程序控制原理工作
  + 指令和数据以二进制形式表示，以同等地位存放在存储器中，并可按地址访问
  + 指令由操作码和地址码组成。操作码指明指令的功能，地址码指明操作数与运算结果的存放位置（地址）
  + 将计算机要处理的问题用指令描述，并编程程序，程序存放在存储器中，程序执行的结果即实现了计算机所要完成的任务
  + 系统中所有功能部件受控制器的控制。在控制器的控制下，指令被逐条（顺序）从存储器中取出来执行，产生控制流，在控制流的驱动下完成指令的功能。在此过程中，数据（流）则是被动地调用
  + 在特定条件下，可由跳转类指令根据运算结果或设定的条件改变程序中指令的执行顺序
  + 早期的冯·诺依曼计算机以运算器为中心，IO 设备通过运算器与存储器传送数据

- 存储程序控制原理

  1812 年，巴贝奇(Babbage) 提出了存储程序控制原理的雏形，提出自动计算机必须包含的五大功能，即输入+存储+处理+控制+输出(I+M+P+C+O)

  冯·诺依曼是在电子时代提出把程序存储控制原理用于计算机的第一人，可总结为三条

  + 指令与数据一样，用二进制数字表示
  + 程序存放在存储器中，可以像数据那样读写
  + 使用存储程序控制方式工作

  ![image-20210421115740891](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144254.png)

- 计算机硬件结构的发展

  略

  PC 机

  ![image-20210421115917509](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144255.png)

## 计算机 Flynn 分类法

### 分类

- 按用途分类

  + 通用计算机

    * 个人计算机 PC

      也称电脑，一种面向个人使用的计算机

    * 服务器

      用于高性能实现某种服务的计算机，如：Web 服务器、FTP 服务器等

    * 超级计算机

  + 嵌入式计算机

    专用计算机

### Flynn 分类法

- 简介

  Flynn 分类法是按照计算机在执行程序的过程中信息流的特征进行分类的

- 英文

  CU：控制单元 control unit

  PU：处理单元 processing unit

  MM：主存储器 main memory

  IS：指令流 instruction stream

  CS：控制流 control stream

  DS：数据流 data stream

  S：single 单

  M：multiple 多

- 信息流

  在程序执行中，存在三种信息流：

  + 指令流

    IS，机器执行的指令序列，由存储器流入控制单元（CU）

  + 数据流

    DS，指令流所使用的数据，包括输入数据、中间数据和结果。数据在处理单元（PU）中进行处理

  + 控制流

    指令流进入 CU，由 CU 产生一系列控制流（信号），在控制流的控制下完成指令的功能

- Flynn 分类

  Flynn 按照指令流和数据流将计算机分为四类

  + SISD

    单指令流单数据流

    ![image-20210421135818364](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144256.png)

    一切从 CU 开始，CU 从 MM 中读出 IS，然后给 PU 发送 CS，之后 DS 在 PU 和 MM 之间流动

  + SIMD

    单指令流多数据流

    ![image-20210421135921392](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144257.png)

    CU 只会读出一个 IS，然后发送一个 CS，有多个 DS 在相应的 PU 和 MM 之间流动

    不同数据同时做相同处理，向量计算机进行的向量运算

  + MISD

    多指令流单数据流

    ![image-20210421140044501](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144258.png)

    不同 CU 从相应的 MM 中读出 IS，给相应的 PU 发送 CS，只有一个 DS 在 PU 和 MM 之间流动

    同组数据同时做不同处理，无对应计算机

  + MIMD

    多指令流多数据流

    ![image-20210421140109199](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144259.png)

    多处理机系统、多核处理、多计算机的集群或云计算系统

### 计算机的性能描述

- 性能指标

  ![image-20210421140837487](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144300.png)

- 基准测试程序

  ![image-20210421141001288](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144301.png)

- 速度指标

  ![image-20210421141018882](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144302.png)

### 性能计算

- 执行时间

  也称响应时间

  一个任务从开始到完成所用的时间或计算机完成一个任务所用的总时间

  包括：硬盘访问、内存访问、IO活动、操作系统开销、CPU 执行时间

- 吞吐量

  在给定时间内（并行）完成的总任务数

- 吞吐率

  也称带宽

  单位时间内（并行）完成的任务数

- 性能

  $性能P = \frac{1}{执行时间T} = \frac{完成的总任务数}{给定时间} = 吞吐率$

- 相对性能（性能比）

  $\frac{P_X}{P_Y} = \frac{T_Y}{T_X} = n$

### Amdahl 定律及应用

- 简介

  计算机系统中某部件由于采用某种更快的执行方式使系统性能改进后，整个系统性能的提高与该执行方式的使用频率或占总执行时间的比例有关。

  改善“系统瓶颈”问题， 用于系统改进之后性能提升的测试 。

  用于测算计算机系统的理论运行速度的提升

- Amdahl 定律

  定义了加速比，就是计算机改进后比改进前快了多少倍

  $加速比 = \frac{改进后的系统性能}{改进前的系统性能} = \frac{改进前的系统执行时间}{改进后的系统执行时间}$

  加速比取决于两个因素：

  + 可改进比例 $f_e$

    可改进部分在原系统执行时间中所占的比例，总小于或等于 1

  + 部件加速比 $r_e$

    可改进部分改进后性能提高的程度，总是大于 1 的

  假设改进前的系统执行时间为 $T_0$，改进后的系统执行时间为 $T_n = T_0(1 - f_e + \frac{f_e}{r_e})$

  则加速比 $S_p = \frac{T_0}{T_n} = \frac{1}{1 - f_e + \frac{f_e}{r_e}}$

  多个部件改进后，加速比 $S_p = \frac{1}{(1 - \sum f_e) + \sum (\frac{f_e}{r_e})}$

- 讨论

  + $1 - f_e$ 为不可改进的部分，当可改进部分为 0（即无任何可改进部分）时，系统的加速比 $S_p = 1$。

  + 随着可改进部分的增加（$f_e$ 加大）和改进效果的提高（$r_e$ 增加），系统的加速比 $S_p$ 就会增加。

  + 当 $f_e$ 确定后，既使这部分改进后不再需要时间，即部件加速比 $r_e → ∞$，则 $S_p ＝ 1/(1-f_e)$。可见，系统性能改善受 $1-f_e$ 的限制。

- 例题

  ![image-20210421143951391](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144303.png)

  ![image-20210421144200124](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144304.png)

- 并行系统

  ![image-20210421143956192](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144305.png)

  ![image-20210421144000374](https://gitee.com/twilight_h_1184651848/pic-go-img/raw/master/%E6%9C%BA%E7%BB%84/20210421144306.png)